{"remainingRequest":"/home/mi/XProjects/vue3/vue3-ncov/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mi/XProjects/vue3/vue3-ncov/src/pages/home.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/home/mi/XProjects/vue3/vue3-ncov/src/pages/home.vue","mtime":1582255941367},{"path":"/home/mi/XProjects/vue3/vue3-ncov/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mi/XProjects/vue3/vue3-ncov/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/mi/XProjects/vue3/vue3-ncov/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/mi/XProjects/vue3/vue3-ncov/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mi/XProjects/vue3/vue3-ncov/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKI2FwcCB7CiAgZm9udC1mYW1pbHk6IEF2ZW5pciwgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsKICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsKICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlOwogIHRleHQtYWxpZ246IGNlbnRlcjsKICBjb2xvcjogIzJjM2U1MDsKICBtYXJnaW4tdG9wOiA2MHB4Owp9Ci53cmFwIHsKICAgIGhlaWdodDogODAwcHg7Cn0KLnRhYldyYXAgewogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7Cn0K"},{"version":3,"sources":["home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"home.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <div class=\"wrap\">\n   <Tabs class=\"tabWrap\">\n       <TabPane label=\"疫情分布图\">\n           <h3>疫情分布图</h3>\n           <div class=\"selectWrap\">\n            <span>选择地区:</span><Select v-model=\"state.mapType\" style=\"width:200px\" @on-change=\"handleChangeProvince\">\n                <Option v-for=\"item in state.provinceList\" :value=\"item.value\" :key=\"item.value\">{{ item.label }}</Option>\n            </Select>\n           </div>\n           <hot-map :mapType=\"state.mapType\" :data=\"state.mapList\" :mapTitle=\"state.mapTitle\" :mapData=\"state.mapData\"></hot-map>\n       </TabPane>\n       <!-- <TabPane label=\"疫情趋势图\">\n           疫情趋势图\n       </TabPane> -->\n   </Tabs>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { createComponent, reactive, onMounted } from '@vue/composition-api'\nimport { getChinaJson, getProvinceJson, getVirusData } from '@/service/API'\nimport provinceMap from '@/data/province-map'\nimport HotMap from '@/components/hotMap.vue'\n\ninterface HomeState {\n    mapTitle: string;\n    mapType: string; // 地图类型, 省份or全国\n    mapList: any[];\n    provinceList: any[];\n    mapData: {};\n}\ninterface ProvinceOptItem {\n    label: string;\n    value: string;\n}\n\nexport default createComponent({\n    components: {\n        HotMap\n    },\n    setup() {\n        const provinceList: ProvinceOptItem[] = [{label: '全国', value: '全国'}]\n        for (const val of Object.keys(provinceMap)) {\n            provinceList.push({\n                label: val,\n                value: val\n            })\n        }\n\n        const origin: HomeState = {\n            mapTitle: '',\n            mapType: '全国',\n            mapList: [],\n            provinceList,\n            mapData: {}\n        }\n        const state = reactive(origin)\n\n        // methods\n        const getMapData = async (mapType: string) => {\n            const mapData = mapType === '全国' ? await getChinaJson() : await getProvinceJson(provinceMap[mapType])\n            state.mapData = mapData.data\n        }\n\n        const getMapList = async (mapType: string) => {\n            const res = await getVirusData()\n            const { code, newslist } = res.data\n\n            if (code === 200) {\n                let cities: any[] = []\n                newslist.forEach((item: any) => {\n                    if (item.provinceShortName === mapType) {\n                        cities = item.cities\n                        // provinceName = item.provinceShortName\n                        return\n                    }\n                })\n                if (cities.length !== 0) {\n                    state.mapList = cities.map((city: any) => {\n                        return {\n                            name: city.cityName,\n                            value: city.confirmedCount,\n                            ...city\n                        }\n                    })\n                } else {\n                    state.mapList = newslist.map((province: any) => {\n                        return {\n                            name: province.provinceShortName,\n                            value: province.confirmedCount,\n                            ...province\n                        }\n                    })\n                }\n            }\n        }\n\n        const init = (val: string) => {\n            getMapData(val)\n            getMapList(val)\n        }\n\n        const handleChangeProvince = (value: string) => {\n            init(value)\n        }\n\n        onMounted (() => {\n            init(state.mapType)\n        })\n\n        return {\n            state, \n            handleChangeProvince\n        }\n    }\n})\n</script>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n.wrap {\n    height: 800px;\n}\n.tabWrap {\n    width: 100%;\n    height: 100%;\n}\n</style>\n"]}]}